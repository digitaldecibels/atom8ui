{{ attach_library('core/drupal.ajax') }}
{{ attach_library('core/drupal.dialog.ajax') }}

{{ attach_library('atom8_ui/apikeys') }}




<div x-data="installationsTable()" x-init="fetchData()">

	<div class="flex items-center justify-between mb-4">
		<h2 class="text-lg font-semibold mb-2">Installs (<span class="text-purple-600 text-sm" x-text="installations.length"></span>)</h2>


		<button href="node/add/installation?destination={{ path('<current>')}}" data-dialog-type="modal" data-dialog-options='{"width":600}' class=" use-ajax flex items-center justify-between px-4 py-2 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-purple-600 border border-transparent rounded-lg active:bg-purple-600 hover:bg-purple-700 focus:outline-none focus:shadow-outline-purple">


			<svg class="w-4 h-4 mr-2 -ml-1" fill="currentColor" id='Plus_24' width='24' height='24' viewbox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><rect width='24' height='24' stroke='none' fill='#000000' opacity='0'/>
				<g transform="matrix(1 0 0 1 12 12)">
					<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4;  fill-rule: evenodd; opacity: 1;" transform=" translate(-12, -12)" d="M 11 2 L 11 11 L 2 11 L 2 13 L 11 13 L 11 22 L 13 22 L 13 13 L 22 13 L 22 11 L 13 11 L 13 2 Z" stroke-linecap="round"/>
				</g>
			</svg>


			<span>Add Install</span>
		</button>
	</div>


	<div class="w-full overflow-hidden rounded-lg shadow-xs bg-white  dark:bg-gray-800 mb-8 ">


		<div class="w-full overflow-x-auto">


			<p x-show="loading">Loading data...</p>

			<p x-show="error" style="color: red;">Error:
				<span x-text="error"></span>
			</p>

			{# instlattion table  #}

			<table x-ref="tableContainer" class="w-full" x-show="installations.length > 0 && !loading">
				<thead>
					<tr class="text-xs font-semibold tracking-wide text-left text-gray-500 uppercase border-b dark:border-gray-700 bg-gray-50 dark:text-gray-400 dark:bg-gray-800">
						<th class="px-4 py-3">Title</th>
						<th class="px-4 py-3">Type</th>
						<th class="px-4 py-3">Host</th>
						<th class=" py-3">Actions</th>
					</tr>
				</thead>
				<tbody class="bg-white divide-y dark:divide-gray-700 dark:bg-gray-800">
					<template x-for="installation in installations" :key="installation.id">
						<tr class="text-gray-700 dark:text-gray-400">
							<td class="px-4 py-3 text-sm" x-text="decodeHTML(installation.title)"></td>
							<td class="px-4 py-3 text-sm">
								<div class="flex items-center ">
									<img class="w-10 h-auto" src="{{ theme_path }}/images/n8n.svg" :alt="installation.field_type" :title="installation.field_type"/>
								</div>
							</td>
							<td class="px-4 py-3 text-sm">
								<a class="text-sm font-medium text-purple-600 dark:text-purple-400 hover:underline" target="_blank" :href="installation.field_host" x-text="installation.field_host"></a>
							</td>
							<td>
								<button :href="'node/' + installation.nid + '/edit?destination=/dev-dashboard'" data-dialog-type="modal" data-dialog-options='{"width":600}' class=" use-ajax flex items-center justify-between text-center px-4 py-2 text-sm font-medium   text-white transition-colors duration-150 bg-purple-600 border border-transparent rounded-lg active:bg-purple-600 hover:bg-purple-700 focus:outline-none focus:shadow-outline-purple">
									<svg class="w-3 h-3" fill="currentColor" id='Edit_24' width='24' height='24' viewbox='0 0 24 24' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><rect width='24' height='24' stroke='none' fill='#000000' opacity='0'/>
										<g transform="matrix(1.05 0 0 1.05 12 12)">
											<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill-rule: nonzero; opacity: 1;" transform=" translate(-12.5, -11.5)" d="M 18.414062 2 C 18.158188 2 17.902031 2.0974687 17.707031 2.2929688 L 16 4 L 20 8 L 21.707031 6.2929688 C 22.098031 5.9019687 22.098031 5.2689063 21.707031 4.8789062 L 19.121094 2.2929688 C 18.925594 2.0974687 18.669937 2 18.414062 2 z M 14.5 5.5 L 3 17 L 3 21 L 7 21 L 18.5 9.5 L 14.5 5.5 z" stroke-linecap="round"/>
										</g>
									</svg>
								</button>
							</td>
						</tr>
					</template>
				</tbody>
			</table>

		</div>
	</div>
</div>