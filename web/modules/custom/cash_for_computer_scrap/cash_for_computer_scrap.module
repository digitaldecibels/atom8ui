<?php



function cash_for_computer_scrap_theme($existing, $type, $theme, $path) {
  return [
    'packing_slip' => [
      'variables' => [
        'node' => NULL,
        'config' => NULL,
        'logo' => NULL,
      ],
      'template' => 'packing-slip', // Refers to templates/packing-slip.html.twig
    ],
  ];
}



/**
 * Implements hook_token_info().
 *
 * Defines the tokens for the business address and phone number.
 */
function cash_for_computer_scrap_token_info() {
  $info = [];

  // Define a group for your custom tokens to keep them organized in the UI.
  $info['types']['cash_for_computer_scrap'] = [
    'name' => t('Business Info'),
    'description' => t('Tokens related to the business address and contact information.'),
  ];

  // Define the tokens themselves, placing them under the 'cash_for_computer_scrap' type.
  $info['tokens']['cash_for_computer_scrap'] = [
    'business-address' => [
      'name' => t('Business Address'),
      'description' => t('The full address of the business from the module settings.'),
    ],
    'business-phone' => [
      'name' => t('Business Phone'),
      'description' => t('The primary contact phone number of the business.'),
    ],
        'drop-off-phone' => [
      'name' => t('Drop-off Phone'),
      'description' => t('The phone number to call when dropping off lots.'),
    ],
  ];

  return $info;
}


/**
 * Implements hook_tokens().
 *
 * Replaces the custom tokens with their configuration values.
 */
function cash_for_computer_scrap_tokens($type, $tokens, array $data, array $options, \Drupal\Core\Render\BubbleableMetadata $bubbleable_metadata) {
  $replacements = [];
  $config = \Drupal::config('cash_for_computer_scrap.settings');

  if ($type === 'cash_for_computer_scrap') {
    foreach ($tokens as $name => $original) {
      switch ($name) {
        case 'business-address':
          // The Address field is a 'text_format' type, so we access '.value'.
          $address = $config->get('business_address.value') ?: $config->get('business_address');

          // Optionally strip HTML if the token is used in a plain text context (like SMS).
          $replacements[$original] = strip_tags($address);

          break;

        case 'business-phone':
          // The Phone field is a simple string (textfield/tel).
          $replacements[$original] = $config->get('business_phone');
          break;

          case 'drop-off-phone':
          // The Phone field is a simple string (textfield/tel).
          $replacements[$original] = $config->get('drop_off_phone');
          break;

      }
    }
  }

  return $replacements;
}